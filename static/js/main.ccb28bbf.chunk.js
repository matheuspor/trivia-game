(this["webpackJsonptrivia-game"]=this["webpackJsonptrivia-game"]||[]).push([[0],{107:function(e,t){},108:function(e,t,a){},111:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),i=a.n(c),s=(a(96),a(37)),o=a(38),u=a(19),l=a(14),d=a(17),j=a(34),b=a(35),p=a(47),m=a(41),h=a(39),O=a(2),f=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(j.a)(this,a),(n=t.call(this,e)).state={clicked:!1,timer:30,questionNumber:0,PlayerScore:0,PlayerAssertions:0},n.handleClick=n.handleClick.bind(Object(p.a)(n)),n.setTimer=n.setTimer.bind(Object(p.a)(n)),n}return Object(b.a)(a,[{key:"componentDidMount",value:function(){this.setTimer(),this.updateLocalStorage()}},{key:"componentWillUnmount",value:function(){var e=JSON.parse(localStorage.getItem("state")),t={name:e.player.name,score:e.player.score,picture:e.player.picture},a=JSON.parse(localStorage.getItem("ranking"));a?localStorage.setItem("ranking",JSON.stringify([].concat(Object(d.a)(a),[t]))):localStorage.setItem("ranking",JSON.stringify([t]))}},{key:"handleClick",value:function(e){var t=this,a=e.target,n=this.state,r=n.timer,c=n.questionNumber,i=this.props.questions[c].difficulty,s={easy:1,medium:2,hard:3};"correct-answer"===a.name&&this.setState((function(e){return{PlayerScore:e.PlayerScore+10+r*s[i],PlayerAssertions:e.PlayerAssertions+1}})),this.setState({clicked:!0},(function(){t.updateLocalStorage()}))}},{key:"setTimer",value:function(){var e=this;this.setState({timer:30});var t=setInterval((function(){e.setState((function(e){return{timer:e.timer-1}}),(function(){var a=e.state,n=a.timer,r=a.clicked;(n<=0||r)&&(clearInterval(t),e.setState({clicked:!0}))}))}),1e3)}},{key:"updateLocalStorage",value:function(){var e=this.state,t=e.PlayerAssertions,a=e.PlayerScore,n=this.props.player,r={player:{name:n.name,assertions:t,score:a,gravatarEmail:n.email,picture:n.avatar}};localStorage.setItem("state",JSON.stringify(r))}},{key:"randomAnswers",value:function(e){var t=this,a=this.state,n=a.questionNumber,r=a.clicked,c=[e[n].correct_answer].concat(Object(d.a)(e[n].incorrect_answers)).sort();return Object(O.jsx)("ul",{children:c.map((function(a,c){return a===e[n].correct_answer?Object(O.jsx)("button",{type:"button",onClick:t.handleClick,"data-testid":"correct-answer",disabled:r,id:"correct",className:r?"green-border":"",name:"correct-answer",children:decodeURIComponent(a)},c):Object(O.jsx)("button",{type:"button",disabled:r,id:c,className:r?"red-border":"",name:"wrong-answer","data-testid":"wrong-answer-".concat(c),onClick:t.handleClick,children:decodeURIComponent(a)},c)}))})}},{key:"nextButton",value:function(e){var t=this,a=this.props,n=a.history;e<a.questions.length-1?this.setState((function(e){return{questionNumber:e.questionNumber+1,clicked:!1}}),(function(){t.setTimer()})):n.push("/trivia-game/feedback")}},{key:"render",value:function(){var e=this,t=this.props,a=t.player,n=t.questions,r=this.state,c=r.timer,i=r.questionNumber,s=r.PlayerScore,o=r.clicked;return Object(O.jsxs)("div",{children:[Object(O.jsx)("p",{children:c}),Object(O.jsxs)("header",{children:[Object(O.jsx)("img",{alt:"avatar","data-testid":"header-profile-picture",src:a.avatar}),Object(O.jsxs)("h4",{"data-testid":"header-player-name",children:["Nome:",a.name," ",Object(O.jsxs)("span",{"data-testid":"header-score",children:["Score:",s]})]})]}),Object(O.jsxs)("div",{children:[Object(O.jsxs)("p",{"data-testid":"question-category",children:["Category:",decodeURIComponent(n[i].category)]}),Object(O.jsx)("h3",{"data-testid":"question-text",children:decodeURIComponent(n[i].question)}),this.randomAnswers(n)]}),o&&Object(O.jsx)("input",{type:"button","data-testid":"btn-next",onClick:function(){return e.nextButton(i)},value:"Pr\xf3xima"})]})}}]),a}(r.a.Component),v=Object(o.b)((function(e){return{questions:e.user.questions,player:e.user.player}}))(f),g=a(4),y=a(18),x=a(13);function k(e,t,a){return Object(O.jsxs)("label",{htmlFor:e,children:["".concat(e[0].toUpperCase()).concat(e.substr(1),":"),Object(O.jsxs)("select",{id:e,name:e,onChange:a,children:[Object(O.jsx)("option",{children:" All "}),"category"===e?t.trivia_categories.map((function(e){return Object(O.jsx)("option",{children:e.name},e.id)})):t.map((function(e){return"True/False"===e?Object(O.jsx)("option",{value:"boolean",children:e},"boolean"):Object(O.jsx)("option",{value:e.toLowerCase(),children:e},e)}))]})]})}var S=Object(n.createContext)();var w=function(){var e=Object(n.useState)({category:"All",difficulty:"All",type:"All"}),t=Object(x.a)(e,2),a=t[0],r=t[1],c=Object(l.f)(),i=Object(n.useContext)(S),s=i.setNewSetting,o=i.categories;function u(e){var t=e.target,n=t.name,c=t.value;if("category"===n){var i=o.trivia_categories.find((function(e){return e.name===c}));r(Object(y.a)(Object(y.a)({},a),{},Object(g.a)({},n,i?i.id:"All")))}else r(Object(y.a)(Object(y.a)({},a),{},Object(g.a)({},n,c)))}return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)("h2",{"data-testid":"settings-title",children:"Settings"}),k("category",o,u),Object(O.jsx)("br",{}),k("difficulty",["Easy","Medium","Hard"],u),Object(O.jsx)("br",{}),k("type",["Multiple","True/False"],u),Object(O.jsx)("br",{}),Object(O.jsx)("button",{type:"button",onClick:function(){s(a),c.push("/trivia-game")},children:" Voltar "})]})},C=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(){return Object(j.a)(this,a),t.apply(this,arguments)}return Object(b.a)(a,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("state")).player;return Object(O.jsxs)("div",{"data-testid":"feedback-text",children:[Object(O.jsx)("h1",{"data-testid":"header-player-name",children:e.name}),Object(O.jsx)("img",{"data-testid":"header-profile-picture",src:e.picture,alt:"avatar"}),Object(O.jsx)("p",{"data-testid":"header-score",children:e.score}),Object(O.jsx)("p",{"data-testid":"feedback-total-score",children:e.score}),Object(O.jsx)("p",{"data-testid":"feedback-total-question",children:e.assertions}),e.assertions<3?"Podia ser melhor...":"Mandou bem!",Object(O.jsx)(s.b,{to:"/trivia-game",children:Object(O.jsx)("button",{type:"button","data-testid":"btn-play-again",children:"Jogar novamente"})}),Object(O.jsx)(s.b,{to:"/trivia-game/ranking",children:Object(O.jsx)("button",{type:"button","data-testid":"btn-ranking",children:"Ver Ranking"})})]})}}]),a}(n.Component),N=function(e){Object(m.a)(a,e);var t=Object(h.a)(a);function a(){var e;return Object(j.a)(this,a),(e=t.call(this)).state={},e}return Object(b.a)(a,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("ranking")),t=this.props.history;return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{"data-testid":"ranking-title",children:"Ranking"}),Object(O.jsx)("ul",{children:e&&e.sort((function(e,t){return t.score-e.score})).map((function(e,t){return Object(O.jsxs)("li",{children:[Object(O.jsx)("span",{"data-testid":"player-name-".concat(t),children:e.name}),Object(O.jsx)("span",{"data-testid":"player-score-".concat(t),children:e.score})]},t)}))}),Object(O.jsx)("button",{type:"button","data-testid":"btn-go-home",onClick:function(){return t.push("/trivia-game")},children:"Play Again"})]})}}]),a}(r.a.Component),P=a(75),A=a.n(P),q=a(160),I=a(153),T=a(161),E=a(155),_="SET_PLAYER_INFO",J="SET_QUESTIONS",R="SET_SETTINGS",U=(a(108),a.p+"static/media/trivia.7e9181d3.png"),W=a(31),B=a.n(W),F=a(50),L=function(){var e=Object(F.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://opentdb.com/api_token.php?command=request").then((function(e){return e.json()})).then((function(e){return e.token}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(F.a)(B.a.mark((function e(t){var a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.gravatar.com/avatar/".concat(t));case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=function(){var e=Object(F.a)(B.a.mark((function e(t,a){var n,r,c;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.keys(a),r="https://opentdb.com/api.php?amount=5&encode=url3986",n.forEach((function(e,t){"All"!==a[e]&&(r+="&".concat(n[t],"=").concat(a[e]))})),e.next=5,fetch("".concat(r,"&").concat(t)).then((function(e){return e.json()})).then((function(e){return e.results}));case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),G=function(){var e=Object(F.a)(B.a.mark((function e(){var t;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://opentdb.com/api_category.php").then((function(e){return e.json()}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=a(156),V=a(159);function z(e){var t=e.name,a=e.user,r=e.handler,c=Object(n.useState)(!1),i=Object(x.a)(c,2),s=i[0],o=i[1];return Object(O.jsx)(Q.a,{type:"Play"===t?"submit":"button",fullWidth:!0,disabled:"Play"===t&&!a.name,onClick:function(){return"Play"===t?o(!0):r()},variant:"contained",sx:{mt:3,mb:2},color:"Play"===t?"primary":"secondary",children:s?Object(O.jsx)(V.a,{color:"secondary"}):t})}var H=a(154),Y=a(158);function $(e){var t=e.name,a=e.handler,n=e.value;return Object(O.jsx)(H.a,{type:"email"===t?"email":"text",margin:"normal",required:"name"===t,fullWidth:!0,id:"".concat(t[0].toUpperCase()).concat(t.substr(1)),label:"email"===t?"Gravatar email:":"Name:",name:t,autoComplete:t,onChange:a,value:n,helperText:"email"===t&&Object(O.jsx)(Y.a,{href:"https://en.gravatar.com/",target:"_blank",underline:"always",children:"Gravatar"})})}var K=a(79),X=Object(K.a)({palette:{background:{default:"#fafafa"},primary:{main:"#212121"},secondary:{main:"#9e9e9e"}}}),Z=Object(E.a)((function(){var e;return{logo:(e={height:"6em"},Object(g.a)(e,X.breakpoints.up("sm"),{height:"9em"}),Object(g.a)(e,"marginBottom","1em"),Object(g.a)(e,"animation","shake infinite 0.82s cubic-bezier(0.36, 0.07, 0.19, 0.97) both"),e)}}));var ee=Object(o.b)((function(e){return{player:e.user.player}}),(function(e){return{sendQuestions:function(t){return e(function(e){return{type:J,payload:e}}(t))},sendPlayer:function(t){return e(function(e){return{type:_,payload:e}}(t))}}}))((function(e){var t=e.sendQuestions,a=e.sendPlayer,r=e.player,c=Object(n.useContext)(S).settings,i=Object(l.f)(),s=Z(),o=Object(n.useState)({name:r.name,email:r.email}),u=Object(x.a)(o,2),d=u[0],j=u[1];function b(e){var t=e.target,a=t.name,n=t.value;j(Object(y.a)(Object(y.a)({},d),{},Object(g.a)({},a,n)))}return Object(n.useEffect)((function(){L().then((function(e){localStorage.setItem("token",e),D(e,c).then((function(e){return t(e)}))}))}),[c,t]),Object(O.jsxs)(q.a,{component:"main",maxWidth:"xs",children:[Object(O.jsx)(I.a,{}),Object(O.jsxs)(T.a,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(O.jsx)("img",{src:U,className:s.logo,alt:"logo"}),Object(O.jsxs)(T.a,{component:"form",onSubmit:function(e){e.preventDefault();var t=A()(d.email).toString();M(t).then((function(e){var t=e.url;j(Object(y.a)(Object(y.a)({},d),{},{avatar:t})),a(Object(y.a)(Object(y.a)({},d),{},{avatar:t})),i.push("/trivia-game/game")}))},noValidate:!0,sx:{mt:1},children:[Object(O.jsx)($,{name:"name",value:d.name,handler:b}),Object(O.jsx)($,{name:"email",value:d.email,handler:b}),Object(O.jsx)(z,{name:"Play",user:d}),Object(O.jsx)(z,{name:"Settings",user:d,handler:function(){return i.push("/trivia-game/settings")}})]})]})]})}));var te=function(e){var t=e.children,a=Object(n.useState)({category:"All",difficulty:"All",type:"All"}),r=Object(x.a)(a,2),c=r[0],i=r[1],s=Object(n.useState)(),o=Object(x.a)(s,2),u=o[0],l=o[1];return Object(n.useEffect)((function(){G().then((function(e){return l(e)}))}),[]),Object(O.jsx)(S.Provider,{value:{settings:c,setNewSetting:function(e){i(e)},setCategories:l,categories:u},children:t})};function ae(){return Object(O.jsx)(te,{children:Object(O.jsxs)(l.c,{children:[Object(O.jsx)(l.a,{exact:!0,path:"/trivia-game",component:ee}),Object(O.jsx)(l.a,{path:"/trivia-game/game",component:v}),Object(O.jsx)(l.a,{path:"/trivia-game/settings",component:w}),Object(O.jsx)(l.a,{path:"/trivia-game/feedback",component:C}),Object(O.jsx)(l.a,{path:"/trivia-game/ranking",component:N})]})})}var ne=a(40),re=a(77),ce=a(78),ie={player:{name:"",email:""},questions:"",settings:{category:"All",difficulty:"All",type:"All"}},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object(y.a)(Object(y.a)({},e),{},{player:t.payload});case J:return Object(y.a)(Object(y.a)({},e),{},{questions:t.payload});case R:return Object(y.a)(Object(y.a)({},e),{},{settings:t.payload});default:return e}},oe=Object(ne.combineReducers)({user:se}),ue=Object(ne.createStore)(oe,Object(re.composeWithDevTools)(Object(ne.applyMiddleware)(ce.a)));window.Cypress&&(window.store=ue);var le=ue;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(Object(O.jsx)(s.a,{children:Object(O.jsx)(o.a,{store:le,children:Object(O.jsx)(u.c,{theme:X,children:Object(O.jsx)(ae,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},96:function(e,t,a){}},[[111,1,2]]]);
//# sourceMappingURL=main.ccb28bbf.chunk.js.map