(this["webpackJsonptrivia-game"]=this["webpackJsonptrivia-game"]||[]).push([[0],{40:function(e,t,n){},52:function(e,t){},53:function(e,t,n){},54:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(24),s=n.n(c),i=(n(40),n(16)),o=n(17),u=n(3),l=n(29),d=n(14),p=n(15),b=n(23),j=n(20),h=n(18),m=n(1),f=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).state={clicked:!1,timer:30,questionNumber:0,PlayerScore:0,PlayerAssertions:0},r.handleClick=r.handleClick.bind(Object(b.a)(r)),r.setTimer=r.setTimer.bind(Object(b.a)(r)),r}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.setTimer(),this.updateLocalStorage()}},{key:"componentWillUnmount",value:function(){var e=JSON.parse(localStorage.getItem("state")),t={name:e.player.name,score:e.player.score,picture:e.player.picture},n=JSON.parse(localStorage.getItem("ranking"));n?localStorage.setItem("ranking",JSON.stringify([].concat(Object(l.a)(n),[t]))):localStorage.setItem("ranking",JSON.stringify([t]))}},{key:"setTimer",value:function(){var e=this;this.setState({timer:30});var t=setInterval((function(){e.setState((function(e){return{timer:e.timer-1}}),(function(){var n=e.state,r=n.timer,a=n.clicked;(r<=0||a)&&(clearInterval(t),e.setState({clicked:!0}))}))}),1e3)}},{key:"handleClick",value:function(e){var t=this,n=e.target,r=this.state,a=r.timer,c=r.questionNumber,s=this.props.questions[c].difficulty,i={easy:1,medium:2,hard:3};"correct-answer"===n.name&&this.setState((function(e){return{PlayerScore:e.PlayerScore+10+a*i[s],PlayerAssertions:e.PlayerAssertions+1}})),this.setState({clicked:!0},(function(){t.updateLocalStorage()}))}},{key:"updateLocalStorage",value:function(){var e=this.state,t=e.PlayerAssertions,n=e.PlayerScore,r=this.props.player,a={player:{name:r.nome,assertions:t,score:n,gravatarEmail:r.email,picture:r.avatar}};localStorage.setItem("state",JSON.stringify(a))}},{key:"randomAnswers",value:function(e){var t=this,n=this.state,r=n.questionNumber,a=n.clicked,c=[e[r].correct_answer].concat(Object(l.a)(e[r].incorrect_answers)).sort();return Object(m.jsx)("ul",{children:c.map((function(n,c){return n===e[r].correct_answer?Object(m.jsx)("button",{type:"button",onClick:t.handleClick,"data-testid":"correct-answer",disabled:a,id:"correct",className:a?"green-border":"",name:"correct-answer",children:decodeURIComponent(n)},c):Object(m.jsx)("button",{type:"button",disabled:a,id:c,className:a?"red-border":"",name:"wrong-answer","data-testid":"wrong-answer-".concat(c),onClick:t.handleClick,children:decodeURIComponent(n)},c)}))})}},{key:"nextButton",value:function(e){var t=this,n=this.props,r=n.history;e<n.questions.length-1?this.setState((function(e){return{questionNumber:e.questionNumber+1,clicked:!1}}),(function(){t.setTimer()})):r.push("/feedback")}},{key:"render",value:function(){var e=this,t=this.props,n=t.player,r=t.questions,a=this.state,c=a.timer,s=a.questionNumber,i=a.PlayerScore,o=a.clicked;return Object(m.jsxs)("div",{children:[Object(m.jsx)("p",{children:c}),Object(m.jsxs)("header",{children:[Object(m.jsx)("img",{alt:"avatar","data-testid":"header-profile-picture",src:n.avatar}),Object(m.jsxs)("h4",{"data-testid":"header-player-name",children:["Nome:",n.nome," ",Object(m.jsxs)("span",{"data-testid":"header-score",children:["Score:",i]})]})]}),Object(m.jsxs)("div",{children:[Object(m.jsxs)("p",{"data-testid":"question-category",children:["Category:",decodeURIComponent(r[s].category)]}),Object(m.jsx)("h3",{"data-testid":"question-text",children:decodeURIComponent(r[s].question)}),this.randomAnswers(r)]}),o&&Object(m.jsx)("input",{type:"button","data-testid":"btn-next",onClick:function(){return e.nextButton(s)},value:"Pr\xf3xima"})]})}}]),n}(a.a.Component),O=Object(o.b)((function(e){return{questions:e.user.questions,player:e.user.player}}))(f),y=n(11),g=n(4),v=n(12);function x(e,t,n){return Object(m.jsxs)("label",{htmlFor:e,children:["".concat(e[0].toUpperCase()).concat(e.substr(1),":"),Object(m.jsxs)("select",{id:e,name:e,onChange:n,children:[Object(m.jsx)("option",{children:" All "}),"category"===e?t.trivia_categories.map((function(e){return Object(m.jsx)("option",{children:e.name},e.id)})):t.map((function(e){return"True/False"===e?Object(m.jsx)("option",{value:"boolean",children:e},"boolean"):Object(m.jsx)("option",{value:e.toLowerCase(),children:e},e)}))]})]})}var k=Object(r.createContext)();var S=function(){var e=Object(r.useState)({category:"All",difficulty:"All",type:"All"}),t=Object(v.a)(e,2),n=t[0],a=t[1],c=Object(u.f)(),s=Object(r.useContext)(k),i=s.setNewSetting,o=s.categories;function l(e){var t=e.target,r=t.name,c=t.value;if("category"===r){var s=o.trivia_categories.find((function(e){return e.name===c}));a(Object(g.a)(Object(g.a)({},n),{},Object(y.a)({},r,s?s.id:"All")))}else a(Object(g.a)(Object(g.a)({},n),{},Object(y.a)({},r,c)))}return Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)("h2",{"data-testid":"settings-title",children:"Settings"}),x("category",o,l),Object(m.jsx)("br",{}),x("difficulty",["Easy","Medium","Hard"],l),Object(m.jsx)("br",{}),x("type",["Multiple","True/False"],l),Object(m.jsx)("br",{}),Object(m.jsx)("button",{type:"button",onClick:function(){i(n),c.push("/")},children:" Voltar "})]})},w=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("state")).player;return Object(m.jsxs)("div",{"data-testid":"feedback-text",children:[Object(m.jsx)("h1",{"data-testid":"header-player-name",children:e.name}),Object(m.jsx)("img",{"data-testid":"header-profile-picture",src:e.picture,alt:"avatar"}),Object(m.jsx)("p",{"data-testid":"header-score",children:e.score}),Object(m.jsx)("p",{"data-testid":"feedback-total-score",children:e.score}),Object(m.jsx)("p",{"data-testid":"feedback-total-question",children:e.assertions}),e.assertions<3?"Podia ser melhor...":"Mandou bem!",Object(m.jsx)(i.b,{to:"/",children:Object(m.jsx)("button",{type:"button","data-testid":"btn-play-again",children:"Jogar novamente"})}),Object(m.jsx)(i.b,{to:"/ranking",children:Object(m.jsx)("button",{type:"button","data-testid":"btn-ranking",children:"Ver Ranking"})})]})}}]),n}(r.Component),C=function(e){Object(j.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(d.a)(this,n),(e=t.call(this)).state={},e}return Object(p.a)(n,[{key:"render",value:function(){var e=JSON.parse(localStorage.getItem("ranking")),t=this.props.history;return Object(m.jsxs)("div",{children:[Object(m.jsx)("h2",{"data-testid":"ranking-title",children:"Ranking"}),Object(m.jsx)("ul",{children:e&&e.sort((function(e,t){return t.score-e.score})).map((function(e,t){return Object(m.jsxs)("li",{children:[Object(m.jsx)("span",{"data-testid":"player-name-".concat(t),children:e.name}),Object(m.jsx)("span",{"data-testid":"player-score-".concat(t),children:e.score})]},t)}))}),Object(m.jsx)("button",{type:"button","data-testid":"btn-go-home",onClick:function(){return t.push("/")},children:"Play Again"})]})}}]),n}(a.a.Component),N=n(6),A=n.n(N),q=n(10),I=n(33),P=n.n(I),T="SET_PLAYER_INFO",J="SET_QUESTIONS",E="SET_SETTINGS",_=(n(53),n.p+"static/media/trivia.7e9181d3.png"),U=function(){var e=Object(q.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://opentdb.com/api_token.php?command=request").then((function(e){return e.json()})).then((function(e){return e.token}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(q.a)(A.a.mark((function e(t){var n;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.gravatar.com/avatar/".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(q.a)(A.a.mark((function e(t,n){var r,a,c;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.keys(n),a="https://opentdb.com/api.php?amount=5&encode=url3986",r.forEach((function(e,t){"All"!==n[e]&&(a+="&".concat(r[t],"=").concat(n[e]))})),e.next=5,fetch("".concat(a,"&").concat(t)).then((function(e){return e.json()})).then((function(e){return e.results}));case 5:return c=e.sent,e.abrupt("return",c);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),L=function(){var e=Object(q.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://opentdb.com/api_category.php").then((function(e){return e.json()}));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function M(e,t){return Object(m.jsxs)("label",{htmlFor:e,children:["".concat(e[0].toUpperCase()).concat(e.substr(1),":"),Object(m.jsx)("input",{type:"email"===e?"email":"text",name:e,id:e,"data-testid":"email"===e?"input-gravatar-email":"input-player-name",onChange:t})]})}function B(e,t,n){return Object(m.jsx)("button",{type:"Jogar"===e?"submit":"button","data-testid":"Jogar"===e?"btn-play":"btn-settings",disabled:"Jogar"===e&&(!t.email||!t.nome),onClick:"Jogar"===e?null:function(){return n()},children:e})}var W=Object(o.b)(null,(function(e){return{sendToken:function(t){return e(function(e){return{type:J,payload:e}}(t))},sendPlayer:function(t){return e(function(e){return{type:T,payload:e}}(t))}}}))((function(e){var t=e.sendToken,n=e.sendPlayer,a=Object(r.useContext)(k),c=a.settings,s=a.setNewCategories,i=Object(u.f)(),o=Object(r.useState)({nome:"",email:""}),l=Object(v.a)(o,2),d=l[0],p=l[1];function b(){return(b=Object(q.a)(A.a.mark((function e(){var t;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:t=e.sent,s(t),i.push("/settings");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){var t=e.target,n=t.name,r=t.value;p(Object(g.a)(Object(g.a)({},d),{},Object(y.a)({},n,r)))}function h(){return(h=Object(q.a)(A.a.mark((function e(n){var r,a,s,i;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,U();case 3:return r=e.sent,e.next=6,F(r,c);case 6:return a=e.sent,localStorage.setItem("token",r),t(a),s=P()(d.email).toString(),e.next=12,R(s);case 12:i=e.sent,p(Object(g.a)(Object(g.a)({},d),{},{avatar:i.url}));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){d.avatar&&(n(d),i.push("/game"))})),Object(m.jsxs)("form",{className:"App-header",onSubmit:function(e){return h.apply(this,arguments)},children:[Object(m.jsx)("img",{src:_,className:"App-logo",alt:"logo"}),Object(m.jsx)("p",{children:"SUA VEZ"}),M("nome",j),M("email",j),B("Jogar",d),B("Configura\xe7\xf5es",d,(function(){return b.apply(this,arguments)}))]})}));var D=function(e){var t=e.children,n=Object(r.useState)({category:"All",difficulty:"All",type:"All"}),a=Object(v.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)(),o=Object(v.a)(i,2),u=o[0],l=o[1];return Object(m.jsx)(k.Provider,{value:{settings:c,setNewSetting:function(e){s(e)},setNewCategories:function(e){l(e)},categories:u},children:t})};function V(){return Object(m.jsx)(D,{children:Object(m.jsxs)(u.c,{children:[Object(m.jsx)(u.a,{exact:!0,path:"/trivia-game",component:W}),Object(m.jsx)(u.a,{path:"/game",component:O}),Object(m.jsx)(u.a,{path:"/settings",component:S}),Object(m.jsx)(u.a,{path:"/feedback",component:w}),Object(m.jsx)(u.a,{path:"/ranking",component:C})]})})}var G=n(19),H=n(34),Q=n(35),Y={player:{},questions:"",settings:{category:"All",difficulty:"All",type:"All"}},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return Object(g.a)(Object(g.a)({},e),{},{player:t.payload});case J:return Object(g.a)(Object(g.a)({},e),{},{questions:t.payload});case E:return Object(g.a)(Object(g.a)({},e),{},{settings:t.payload});default:return e}},$=Object(G.combineReducers)({user:Z}),z=Object(G.createStore)($,Object(H.composeWithDevTools)(Object(G.applyMiddleware)(Q.a)));window.Cypress&&(window.store=z);var K=z;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(m.jsx)(i.a,{children:Object(m.jsx)(o.a,{store:K,children:Object(m.jsx)(V,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[54,1,2]]]);
//# sourceMappingURL=main.159cec84.chunk.js.map